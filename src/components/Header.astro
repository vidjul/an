---
import { getCollection } from 'astro:content';
import URLBar from './URLBar';
import type { Route } from '../types/navigation';

// Static pages
const pages: Route[] = [
  {
    type: 'page',
    path: '/an',
    displayPath: '',
    label: 'Home',
    category: 'Pages',
    searchTerms: ['home', 'index'],
  },
  {
    type: 'page',
    path: '/an/posts',
    displayPath: 'posts',
    label: 'Posts',
    category: 'Pages',
    searchTerms: ['posts', 'blog', 'articles'],
  },
  {
    type: 'page',
    path: '/an/about',
    displayPath: 'about',
    label: 'About',
    category: 'Pages',
    searchTerms: ['about', 'info'],
  },
];

// Dynamic posts from Content Collections
const posts = await getCollection('posts');
const postRoutes: Route[] = posts.map((post) => ({
  type: 'post',
  path: `/an/posts/${post.slug}`,
  displayPath: `posts/${post.slug}`,
  label: post.data.title,
  category: 'Posts',
  searchTerms: [post.data.title, post.slug, ...(post.data.excerpt ? [post.data.excerpt] : [])],
}));

// Combine all routes
const allRoutes = [...pages, ...postRoutes];

// Get current path
const currentPath = Astro.url.pathname;
---

<header class="sticky top-0 z-10 bg-white px-4 py-8 font-display text-xl shadow-xs md:px-16">
  <URLBar client:load routes={allRoutes} currentPath={currentPath} />
</header>
